setwd("C:/classwork/isye6501/Week05")
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
crime
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
linmodel
AIC(linmodel)
crime
ncol(crime)
16!
fact(16)
linmodel$adjusted.r2
attributes(linmodel0
a
attributes(linmodel)
summary(linmodel)
attributes(summary(linmodel))
summary(linmodel)$adj.r.squared
crime
1:16
train[,16]
crime[,16]
crime
1:1
value <- null
value <- NULL
value
value <- 2
aicmax <- NULL
aicmax >2
aicmax <2
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
aic
aicmin
aic < aicmin
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
install.packages("MASS")
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
step
step$anova
fit
step
fit
step
predict(step, test[,1:15])
nrow(test)
step$anova
predict(test)
predict(step)
predict(step,test)
test[,Crime] - predict(step,test)
test[,'Crime'] - predict(step,test)
test[,'Crime']
(predict(step,test) - test[,'Crime'])/test[,'Crime']
(predict(step,test) - test[,'Crime'])^2
(predict(step,test) - test[,'Crime'])^2
mean((predict(step,test) - test[,'Crime'])^2)
sqrt(mean((predict(step,test) - test[,'Crime'])^2))
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
install.packages("glmnet")
scale(crime)
train[,1:15]
data.matrix(train[,1:15])
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
predict(lassomodel,test)
lassomodel
attributes(lassomodel)
predict(lassomodel,test)
predict(lassomodel,as.matrix(test))
predict(lassomodel,as.matrix(test[,1:15]))
as.matrix(test[,1:15])
test
as.matrix(test[,1:15])
predict(lassomodel,as.matrix(test[,1:15]))
lassomodel
predict(lassomodel,as.matrix(test[,1:15]))
lassomodel
step
lassomodel
lassomodel[29,]
lassomodel[29]
lassomodel[29,,]
lassomodel[29,]
attributes(lassomodel)
lassomodel$df
lassomodel$glmnet
lassomodel$elnet
predict(lassomodel,test)
predict(lassomodel,as.matrix(test[,1:15]))
predict(lassomodel,as.matrix(test[,1:15]))['s28']
predict(lassomodel,as.matrix(test[,1:15]))[,'s28']
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
RMSE_stepwise
RMSE_lasso
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
RMSE_stepwise
RMSE_lasso
RMSE_lasso <- sqrt(mean((predict(lassomodel,as.matrix(test[,1:15]))[,'s27'] - test[,'Crime'])^2))
RMSE_lasso
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
RMSE_stepwise
RMSE_lasso
predict(lassomodel,as.matrix(test[,1:15]))
lassomodel
lassomodel[,'Df']
lassomodel['Df']
lassomodel$df
attributes(lassomodel)
lassomodel$df
match(lassomodel$df, 8)
lassomodel
match(lassomodel$df, 8)
which(lassomodel$df == 8)
which(lassomodel$df == 8)[len(which(lassomodel$df == 8))]
which(lassomodel$df == 8)[length(which(lassomodel$df == 8))]
which(lassomodel$df == 8)[length(which(lassomodel$df == 8))] + 1
cat("s", which(lassomodel$df == 8)[length(which(lassomodel$df == 8))] + 1)
cat("s",which(lassomodel$df == 8)[length(which(lassomodel$df == 8))] + 1)
paste("s",which(lassomodel$df == 8)[length(which(lassomodel$df == 8))] + 1)
paste("s",which(lassomodel$df == 8)[length(which(lassomodel$df == 8))] + 1, sep="")
step
attributes(step)
step$rank
help(step)
fit <- lm(Crime~.,data=train)
step <- stepAIC(fit, direction="both")
step$anova
crime
fit <- lm(Crime~.,data=train[,3:8])
step <- stepAIC(fit, direction="both")
step$anova
step
fit <- lm(Crime~.,data=train[,3:5])
step <- stepAIC(fit, direction="both")
step$anova
fit <- lm(Crime~.,data=train[,3:5])
step <- stepAIC(fit, direction="both")
step$anova
fit <- lm(Crime~.,data=train[,3:5])
fit <- lm(Crime~.,data=train[,13:16])
fit
fit$rank
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
RMSE_stepwise
RMSE_lasso
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
RMSE_stepwise
RMSE_lasso
train
scale(train)
train
preProcess(train[,1:15])
library(caret)
preProcess(train[,1:15])
preProcess(train[,-16])
scalefunc <- preProcess(train[,-16])
train_scaled <- predict(scalefunc, train[,-16])
train_scaled
crime
crime[,-'So']
crime[,-So]
crime[,So]
crime[,'So']
crime[,-'So']
crime[,'So']
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
as.matrix(test_scaled[,1:ncol(train) - 1])
test_scaled
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
as.matrix(test_scaled[,1:ncol(train) - 1])
test_scaled[,1:ncol(train) - 1]
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
lassomodel_pred_col
lassomdel
lassomodel
degfree
lassomodel$df == degfree
length(which(lassomodel$df == degfree))
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
train_scaled
train
train_scaled
lassomodel
degfree
step
lassomodel
lassomodel_pred_col
test_scaled
test_scaled
lassomodel_preds
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
test_scaled[,-ncol(train)]
as.matrix(test_scaled[,-ncol(train)])
as.matrix(test_scaled[,-ncol(train)])[1,1]
as.matrix(test_scaled[,-ncol(train)])[1,1] + 2
as.matrix(test_scaled[,-ncol(train)])[1,1] + 2.0
class(test_scaled)
test_scaled
test_scaled[1,1]
test_scaled[1,1] + 2
as.matrix(test_scaled)
as.matrix(sapply(test_scaled, as.numeric))
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
RMSE_lasso
RMSE_stepwise
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
RMSE_lasso
RMSE_stepwise
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
RMSE_lasso
RMSE_stepwise
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
cbind(predict(scalefunc, train[,-ncol(train)]), Crime=train[,ncol(train)])
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
ridgemodel_preds
ridgemodel_pred_col
ridgemodel_pred_col
degfree
ridgemodel
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
ridgemodel
attributes(ridgemodel)
summary(ridgemodel)
attributes(ridgemodel)
ridgemodel$a0
ridgemodel$dim
ridgemodeljerr
ridgemodel$jerr
ridgemodel$elnet
ridgemodel$glmnet
attributes(summary(ridgemodel))
coef(ridgemodel)
tmp_coeffs <- coef(ridgemodel, s = "lambda.min")
data.frame(name = tmp_coeffs@Dimnames[[1]][tmp_coeffs@i + 1], coefficient = tmp_coeffs@x)
tmp_coeffs <- coef(ridgemodel, s = "lambda.min")
coef(ridgemodel)
coef(ridgemodel)$Dimnames
coef(ridgemodel)$i
coef(ridgemodel)@Dimnames
coef(ridgemodel)@Dimnames[[1]]
coef(ridgemodel)@i
coef(ridgemodel)@i + 1
coef(ridgemodel)@x
tmp_coeffs <- coef(ridgemodel)
data.frame(name = tmp_coeffs@Dimnames[[1]][tmp_coeffs@i + 1], coefficient = tmp_coeffs@x)
tmp_coeffs <- coef(ridgemodel, s = "lambda.min")
tmp_coeffs
tmp_coeffs@p
attributes(tmp_coeffs)
ridgemodel
data.frame(name = tmp_coeffs@Dimnames[[1]][tmp_coeffs@i + 1], coefficient = tmp_coeffs@x)
tmp_coeffs@Dimnames[[1]]
tmp_coeffs@i
coef(ridgemodel)
class(coef(ridgemodel))
dim(coef(ridgemodel))
coef(ridgemodel)[,100]
coef(ridgemodel)[,1]
coef(ridgemodel)[,1]
ridgemodel
coef(ridgemodel)[,100]
coef(ridgemodel)[,1]
coef(ridgemodel)[,1]
coef(ridgemodel)[,100]
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
elasticmodel_preds
elasticmodel_pred_col
elasticmodel_preds
degfree
lassomodel
elasticmodel
a
glmnet(x=data.matrix(train_scaled[,-ncol(train)]), y=data.matrix(train_scaled[,ncol(train)]), alpha=1)
cv.glmnet(x=data.matrix(train_scaled[,-ncol(train)]), y=data.matrix(train_scaled[,ncol(train)]), alpha=1)
attributes(lassomodel)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
attributes(lassomodel)
lassomodel$lambda
cv.glmnet(x=data.matrix(train_scaled[,-ncol(train)]), y=data.matrix(train_scaled[,ncol(train)]), alpha=1)
a<- cv.glmnet(x=data.matrix(train_scaled[,-ncol(train)]), y=data.matrix(train_scaled[,ncol(train)]), alpha=1)
a$lambda.min
a$lambda == a$lambda.min
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
lassomodel
lassomodel_pred_col
lassomodel
RMSE_lasso
lassomodel_pred_col
sqrt(mean((lassomodel_preds[,lassomodel_pred_col] - test[,'Crime'])^2))
lassomodel_preds[,lassomodel_pred_col]
lassomodel_preds
test_scaled
nrow(test_scaled)
lassomodel
lassomodel$glmnet.fit
lassomodel$glmnet.fit
lassomodel
lassomodel$glmnet.fit
predict(lassomodel,as.matrix(as.matrix(sapply(test_scaled, as.numeric))[,-ncol(train)]))
attributes(predict(lassomodel,as.matrix(as.matrix(sapply(test_scaled, as.numeric))[,-ncol(train)])))
predict(lassomodel,as.matrix(as.matrix(sapply(test_scaled, as.numeric))[,-ncol(train)]))
lassomodel
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
lassomodel_pred
test[,'Crime']
lassomodel
lassomodel$lambda.min
lassomodel$glmnet.fit
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
elasticmodel_preds
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
fit <- lm(Crime~.,data=train)
fit
fit <- cv.lm(Crime~.,data=train)
cv.lm(Crime~.,data=train)
cv.lm
library(DAAG)
install.packages("DAAG")
library(DAAG)
cv.lm(Crime~.,data=train)
step
cv.lm(step)
fit
attributes(fit)
fit$model
fit$lm
attributes(fit)
attributes(fit)
fit$call
fit$call[3]
fit$call[2]
fit$call[1]
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
mean(RMSE_stepwise_list)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
RMSE_elastic_list_list
seq(1:length(RMSE_elastic_list_list))
seq(1:length(RMSE_elastic_list_list),3)
seq(1,length(RMSE_elastic_list_list))
seq(1,length(RMSE_elastic_list_list),3)
RMSE_elastic_list_list[seq(1,length(RMSE_elastic_list_list),3)]
source('C:/classwork/isye6501/Week05/HW05-11.1b.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
source('C:/classwork/isye6501/Week05/HW05-11.1.R', echo=TRUE)
